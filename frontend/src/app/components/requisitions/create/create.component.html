
<div class="card card-register mx-auto mt-5">
  <div class="card-header">Add a Requisitions</div>
  <div class="card-body">
    <form [formGroup]="createForm">
      <div class="form-group">
        <div class="form-label-group">
          <label for="diner">Diner</label>
            <select formControlName="diner" class="form-control col-md-6" id="diner" required="required" #diner>
              <option *ngFor="let d of dinners" value="{{d._name}}" >
                {{d._name}}
              </option>
            </select>
        </div>
      </div>

      <div *ngFor="let c of productsByCat; let j = index">
        <h4>{{c.category}}</h4>

      <!-- forma de los productos -->
        <form #formRef="ngForm">
        <div *ngFor="let o of c.orders; let i = index" >
          <div class="form-group">
            <label >Product</label>
            <select [(ngModel)]="c.orders[i].product" name="name{{i}}" #v (change)="fetchProductData(v.value)"  class="form-control col-md-6" #name="ngModel" required >
              <option *ngFor="let p of products" value="{{p._name}}" >
                {{p._name}}
              </option>
            </select>
            <label >Quantity</label>
            <input type="number" [(ngModel)]="c.orders[i].quantity" name="name{{i}}" class="form-control col-md-6" #name="ngModel" required />
            <label >Units</label>
            <select [(ngModel)]="c.orders[i].unit" name="name{{i}}" class="form-control col-md-6" #name="ngModel" required >
              <option *ngFor="let u of unities" value="{{u._name}}" >
                {{u._name}}
              </option>
            </select>
            <label >Provider</label>
            <div class="form-group">
              <div class="form-label-group">
                <!--<label for="category">Category</label>-->
                <select [(ngModel)]="c.orders[i].provider" name="name{{i}}" class="form-control col-md-6" #name="ngModel" required #provider>
                  <option *ngFor="let p of providers" value="{{p._name}}" >
                    {{p._name}}
                  </option>
                </select>
              </div>
              {{productsByCat | json}}}
            </div>
          </div>
          <br />
        </div>
        <button class="btn btn-primary " [disabled]="!formRef.form.valid" (click)="add(j)">Add Item</button>
      </form>
        <br />
      </div>
      <button class="btn" routerLink="/requisitions/list">Back</button>
      <button class="btn btn-primary " type="submit" (click)="addRequisition(diner.value )" [disabled]="createForm.pristine || createForm.invalid" mat-raised-button color="primary" >Save</button>
    </form>
  </div>
</div>

